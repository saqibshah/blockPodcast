!function(){"use strict";var e={n:function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,{a:a}),a},d:function(t,a){for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.blocks,a=window.wp.element,l=window.wp.i18n,n=window.wp.blockEditor,s=window.wp.components,i=window.wp.apiFetch,o=e.n(i);(0,t.registerBlockType)("create-block/ss-podcast",{attributes:{podcastURL:{type:"string"},podcastEpisodes:{type:"array"},episodesSelected:{type:"string"},mediaId:{type:"number",default:0},mediaUrl:{type:"string",default:""},mediaObj:{type:"object"},mainTitle:{type:"string",default:""},timestamps:{type:"array"},audioTitle:{type:"string",default:""},shortDescription:{type:"string",default:""},mainDesc:{type:"string",default:""},itemDesc:{type:"string",default:""},alignment:{type:"string",default:"none"}},edit:function(e){let{attributes:t,setAttributes:i}=e;const r=e=>{i({mediaId:e.id,mediaUrl:e.url,mediaObj:e})},c=()=>{const e=[...t.timestamps];e.sort((function(e,t){return e.startSeconds-t.startSeconds})),e.map(((t,a)=>{a+1<e.length&&(e[a].endSeconds=e[a+1].startSeconds-1)})),i({timestamps:e})},m=(e,a,l)=>{const n=[...t.timestamps];n[a][l]=e;let s=!1;if("start"==l){let t;if(/^([0-1]?[0-9]|2[0-4]):([0-5][0-9])(:[0-5][0-9])|([0-1]?[0-9]|2[0-4]):([0-5][0-9])?$/.test(e)){n[a].is_valid=!1;let l=e.split(":");console.log(l.length),t=l.length>2?3600*l[0]+60*l[1]+1*l[2]:60*l[0]+1*l[1],n[a].error=!1,n[a].startSeconds=t,s=!0}else n[a].error=!0,n[a].startSeconds=!1}i({timestamps:n}),s&&c()};let d,p,u;return t.timestamps&&t.timestamps.length>0&&(p=t.timestamps.map(((e,n)=>(0,a.createElement)("div",null,(0,a.createElement)(s.__experimentalSpacer,{marginBottom:2,marginTop:4},(0,a.createElement)(s.__experimentalHStack,{key:n},(0,a.createElement)(s.TextControl,{placeholder:(0,l.__)("hh:mm:ss - Start","ss-podcast"),value:e.start,onChange:e=>m(e,n,"start")}),(0,a.createElement)(s.TextControl,{placeholder:(0,l.__)("Title","ss-podcast"),value:e.title,onChange:e=>m(e,n,"title")}),(0,a.createElement)(s.Dashicon,{icon:"admin-home",className:"grf__remove-location-address",icon:"\tdashicons-remove",label:"RemoveDelete",onClick:()=>(e=>{const a=[...t.timestamps];a.splice(e,1),i({timestamps:a})})(n)}))),(0,a.createElement)(s.__experimentalDivider,{margin:0})))),d=(0,a.createElement)("div",null,(0,a.createElement)(s.__experimentalSpacer,{marginBottom:3},(0,a.createElement)(s.__experimentalHStack,null,(0,a.createElement)(s.__experimentalText,null,(0,a.createElement)("strong",null,"Start Time")),(0,a.createElement)(s.__experimentalText,null,(0,a.createElement)("strong",null,"Title")),(0,a.createElement)(s.__experimentalText,null,(0,a.createElement)("strong",null)))),(0,a.createElement)(s.__experimentalDivider,null))),"timestamps"in t||i({timestamps:[]}),u=t.isLoading?(0,a.createElement)("div",{className:"text-center"},(0,a.createElement)(s.__experimentalText,null,"Loading Please Wait ...")):t.mediaUrl?(0,a.createElement)("div",null,(0,a.createElement)(s.PanelBody,{title:"Podcast Details"},(0,a.createElement)(s.SelectControl,{label:(0,l.__)("Podcast Episodes","ss-podcast"),value:t.episodesSelected,onChange:e=>{if(e){const t=JSON.parse(e);i({episodesSelected:e,itemDesc:t.description})}else i({episodesSelected:"",itemDesc:""})},options:t.podcastEpisodes,className:"select-episode"}),(0,a.createElement)(s.TextControl,{label:(0,l.__)("Podcast Top Text","ss-podcast"),placeholder:(0,l.__)("Podcast Title","ss-podcast"),value:t.mainTitle,onChange:e=>i({mainTitle:e}),className:"components-placeholder__input"}),(0,a.createElement)(s.TextControl,{label:(0,l.__)("Audio Title","ss-podcast"),placeholder:(0,l.__)("Audio Title","ss-podcast"),value:t.audioTitle,onChange:e=>i({audioTitle:e}),className:"components-placeholder__input"})),(0,a.createElement)(s.PanelBody,{title:"Podcast Description"},(0,a.createElement)(s.TextareaControl,{label:(0,l.__)("Short Description","ss-podcast"),placeholder:(0,l.__)("Short Description","ss-podcast"),value:t.shortDescription,onChange:e=>i({shortDescription:e}),className:"components-placeholder__input"}),(0,a.createElement)(s.__experimentalText,null,(0,a.createElement)("strong",null,"Description")),(0,a.createElement)(n.RichText,{tagName:"div",multiline:"p",value:t.itemDesc,onChange:e=>i({itemDesc:e}),placeholder:"Episode Description"})),(0,a.createElement)(s.PanelBody,{title:(0,l.__)("Timestamps ("+t.timestamps.length+")")},(0,a.createElement)(s.Card,null,(0,a.createElement)(s.CardBody,null,d,p,(0,a.createElement)(s.__experimentalSpacer,{marginBottom:6}),(0,a.createElement)(s.__experimentalHStack,null,(0,a.createElement)(s.Button,{isDestructive:!0,onClick:(()=>{i({timestamps:[]})}).bind(this)},(0,l.__)("Delete All")),(0,a.createElement)("div",null,(0,a.createElement)(s.Button,{variant:"secondary",onClick:c.bind(this)},(0,l.__)("Sort")),(0,a.createElement)(s.Button,{isDefault:!0,onClick:(()=>{const e=[...t.timestamps];e.push({start:"",title:"",startSeconds:!1,endSeconds:!1}),i({timestamps:e})}).bind(this)},(0,l.__)("Add Timestamp")))))))):(0,a.createElement)("div",{className:"text-center"},(0,a.createElement)(s.__experimentalText,null,'Add feed url and press "Pull Data"')),(0,a.createElement)("div",(0,n.useBlockProps)(),(0,a.createElement)(s.Card,null,(0,a.createElement)(s.CardBody,null,(0,a.createElement)(s.PanelBody,{title:"Feed URL"},(0,a.createElement)("form",{onSubmit:e=>{e.preventDefault();const{podcastURL:a}=t;i({isLoading:!0}),o()({path:"/ss-podcast/v1/getxml/"+btoa(a),method:"POST",data:{url:btoa(a)}}).then((e=>{const a=[{label:"Choose Episode",value:""},...e.items];i({mainTitle:e.title,mainDesc:e.description,podcastEpisodes:a,mediaUrl:e.image.url?e.image.url:"",mediaId:0,mediaObj:void 0,timestamps:t.timestamps?t.timestamps:[],isLoading:!1})})).catch((e=>{console.log(e)}))}},(0,a.createElement)(s.TextControl,{Card:(0,l.__)("Enter URL hereâ€¦","ss-podcast"),value:t.podcastURL,onChange:e=>i({podcastURL:e}),label:"Enter Feed URL",className:"components-placeholder__input"}),(0,a.createElement)(s.Button,{isDefault:!0,type:"submit"},(0,l.__)("Pull Data","ss-podcast")))),u)),(0,a.createElement)(n.InspectorControls,null,(0,a.createElement)(s.PanelBody,{initialOpen:!0,title:(0,l.__)("Podcast Thumbnail","ss-podcast")},(0,a.createElement)("div",{className:"editor-post-featured-image components-base-control"},(0,a.createElement)(n.MediaUploadCheck,null,(0,a.createElement)(n.MediaUpload,{onSelect:r,value:t.mediaId,allowedTypes:["image"],render:e=>{let{open:n}=e;return(0,a.createElement)(s.Button,{className:(t.mediaId,"editor-post-featured-image__preview"),onClick:n},0==t.mediaId&&(0,a.createElement)("div",null,(0,a.createElement)(s.ResponsiveWrapper,{naturalWidth:500,naturalHeight:400},(0,a.createElement)("img",{src:t.mediaUrl,style:{maxHeight:"100%"}})),(0,l.__)("Click to choose different Featured Image","ss-podcast")),null!=t.mediaObj&&(0,a.createElement)(s.ResponsiveWrapper,{naturalWidth:t.mediaObj.width,naturalHeight:t.mediaObj.height},(0,a.createElement)("img",{src:t.mediaObj.url})))}})),0!=t.mediaId&&(0,a.createElement)(n.MediaUploadCheck,null,(0,a.createElement)(n.MediaUpload,{title:(0,l.__)("Replace image","ss-podcast"),value:t.mediaId,onSelect:r,allowedTypes:["image"],render:e=>{let{open:t}=e;return(0,a.createElement)(s.Button,{onClick:t,isDefault:!0,isLarge:!0},(0,l.__)("Replace image","ss-podcast"))}})),0!=t.mediaId&&(0,a.createElement)(n.MediaUploadCheck,null,(0,a.createElement)(s.Button,{onClick:()=>{i({mediaId:0,mediaUrl:"",mediaObj:void 0})},isLink:!0,isDestructive:!0},(0,l.__)("Remove image","ss-podcast")))))))},save:function(e){let{attributes:t}=e;const l=n.useBlockProps.save({className:"alignwide"});return t.podcastEpisodes&&t.podcastEpisodes.length>0&&t.podcastEpisodes.filter((e=>e.value===t.episodesSelected)),(0,a.createElement)("div",l,t.podcastEpisodes&&t.podcastEpisodes.length>0&&(0,a.createElement)("div",null,null))}})}();